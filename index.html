<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hybrid Alpha Factor Project</title>
    <style>
    /* 新增表格和图片样式 */
        .tabs {
            margin: 30px 0;
            border-bottom: 2px solid #3498db;
        }
        
        .tablinks {
            background: #f8f9fa;
            border: none;
            padding: 12px 25px;
            margin-right: 5px;
            cursor: pointer;
            border-radius: 5px 5px 0 0;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .tablinks.active {
            background: #3498db;
            color: white;
        }
        
        .tabcontent {
            display: none;
            padding: 20px;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .tabcontent.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        .data-table {
            width: 100%;
            overflow-x: auto;
            margin: 20px 0;
        }
        
        .data-table table {
            min-width: 1000px;
        }
        
        .data-table th {
            background: #3498db;
            color: white;
            white-space: nowrap;
        }
        
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(2, 1fr));
            gap: 30px;
            margin: 40px 0;
        }
        .image-gallery {
            /* 修改为固定两列布局 */
            grid-template-columns: repeat(2, 1fr); 
            /* 增加图片高度 */
            gap: 30px;
        }
        .gallery-item {
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .gallery-item img {
            width: 100%;
            height: 300px;
            object-fit: contain;
        }
        
        .gallery-caption {
            padding: 15px;
            background: #f8f9fa;
            text-align: center;
        }
    
        @keyframes fadeIn {
            from {opacity: 0;}
            to {opacity: 1;}
        }
	
	/* 移动端适配 */
        @media (max-width: 768px) {
            .image-gallery {
                grid-template-columns: 1fr;  /* 小屏幕单列显示 */
            }
            .gallery-item img {
                height: 250px;
            }
        }

        /* Base Styles */
        body, html {
            margin: 0;
            padding: 0;
            font-family: 'Arial', sans-serif;
            scroll-behavior: smooth;
            height: 100%;
        }
        
        /* Full-screen Sections */
        section {
            min-height: 100vh;
            padding: 80px 20px;
            position: relative;
            box-sizing: border-box;
        }
        
        /* Homepage */
        #home {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), 
                        url('https://jg-app.obs.cn-north-4.myhuaweicloud.com/prod/upload/2/jpg/EF173519C108CE7352D240C5D3D29A8B.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        /* Navigation */
        .nav {
            position: fixed;
            top: 0;
            width: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 15px 0;
            z-index: 1000;
            display: flex;
            justify-content: center;
        }
        
        .nav a {
            color: white;
            text-decoration: none;
            margin: 0 20px;
            font-weight: bold;
            transition: color 0.3s;
            font-size: 1.1rem;
        }
        
        .nav a:hover {
            color: #3498db;
        }
        
        /* Content Containers */
        .content-container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        /* Typography */
        h1 {
            font-size: 2.8rem;
            margin-bottom: 20px;
            line-height: 1.2;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .home-subtitle {
            font-size: 1.4rem;
            max-width: 800px;
            margin-bottom: 30px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }
        
        h2 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 30px;
            text-align: center;
        }
        
        h3 {
            color: #3498db;
            margin-top: 30px;
            font-size: 1.5rem;
        }
        
        p {
            line-height: 1.6;
            font-size: 1.1rem;
            margin-bottom: 15px;
        }
        
        /* Team Members */
        .members {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
        }
        
        .member-card {
            background-color: #f8f9fa;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            text-align: center;
            min-width: 200px;
        }
        
        /* See More Button */
        .see-more {
            display: inline-block;
            margin-top: 30px;
            padding: 12px 30px;
            background-color: #3498db;
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: bold;
            transition: all 0.3s;
            border: 2px solid #3498db;
            font-size: 1.1rem;
        }
        
        .see-more:hover {
            background-color: transparent;
            color: #3498db;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 40px;
            border-radius: 10px;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }
        
        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 1.5rem;
            cursor: pointer;
            color: #777;
        }
        
        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: #3498db;
            color: white;
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
        
        /* Factor Tables */
        .factor-table {
            width: 100%;
            margin: 20px 0;
            border: 1px solid #ddd;
        }
        
        .factor-table th, .factor-table td {
            padding: 12px;
            border: 1px solid #ddd;
        }
        
        .factor-table th {
            background-color: #f2f2f2;
            color: #333;
        }
        
        /* Methodology Sections */
        .methodology-section {
            margin-bottom: 40px;
        }
        
        /* Background Colors */
        #project {
            background-color: #f0f2f5;
        }
        
        #milestones {
            background-color: #e8f4f8;
        }
        
        /* Responsive Adjustments */
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .home-subtitle {
                font-size: 1.1rem;
            }
            
            .content-container {
                padding: 20px;
            }
            
            .nav a {
                margin: 0 10px;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <a href="#home">Home</a>
        <a href="#project">Project</a>
        <a href="#milestones">Milestones</a>
    </nav>

    <!-- Homepage -->
    <section id="home">
        <h1>Enhancing Market Factor Generation Using Hybrid Alpha Strategies</h1>
        <p class="home-subtitle">A Machine Learning and Human-Designed Approach for Quantitative Investment</p>
        <a href="#project" class="see-more">Explore Project</a>
        <a href="#aim-modal" class="see-more" id="see-more-btn" style="margin-left: 15px;">See More</a>
    </section>

    <!-- Project Page -->
    <section id="project" class="page">
        <div class="content-container">
            <h2>Project Overview</h2>
            
            <div class="methodology-section">
                <h3>Mentor</h3>
                <p><strong>Dr. J.R. Zhang</strong></p>
            </div>
            
            <div class="methodology-section">
                <h3>Team Members</h3>
                <div class="members">
                    <div class="member-card">
                        <strong>LIU Kai</strong>
                    </div>
                    <div class="member-card">
                        <strong>ZHANG Yaxuan</strong>
                    </div>
                    <div class="member-card">
                        <strong>LIN Pingyi</strong>
                    </div>
                    <div class="member-card">
                        <strong>CAO Yimeng</strong>
                    </div>
                    <div class="member-card">
                        <strong>LU Xiulin</strong>
                    </div>
                </div>
            </div>
            
            <div class="methodology-section">
                <h3>Methodology</h3>
                <h4>I. Data Collection</h4>
                <ul>
                    <li><strong>Universe:</strong> CSI All Shares Index constituents, excluding Beijing Stock Exchange (BSE) listings, ST stocks, and bottom 20% liquidity (by daily turnover)</li>
                    <li><strong>Frequency:</strong> Daily price, volume, and factor values (human + deep learning)</li>
                    <li><strong>Financial Data Lag:</strong> Use quarterly/annual reports with a 3-month delay</li>
                </ul>
                
                <h4>II. Factor Generation</h4>
                <h5>Human-Designed Factors:</h5>
                <p>We construct four sub-types of human-designed alpha factors using price & volume data:</p>
                
                <table class="factor-table">
                    <tr>
                        <th>Category</th>
                        <th>Example Factors</th>
                    </tr>
                    <tr>
                        <td>Momentum & Reversion</td>
                        <td>close returns, intraday returns, overnight returns, Sharpe ratio variants</td>
                    </tr>
                    <tr>
                        <td>Volatility</td>
                        <td>std of close returns, amplitude metrics, upshadow/downshadow measures</td>
                    </tr>
                    <tr>
                        <td>Liquidity</td>
                        <td>turnover ratio, Amihud's liquidity, trading value metrics</td>
                    </tr>
                    <tr>
                        <td>Price-Volume Correlation</td>
                        <td>correlations between price/returns and trading volume at different lags</td>
                    </tr>
                </table>
                
                <h5>Machine-Learning Generated Factors:</h5>
                <ul>
                    <li><strong>Model Architecture:</strong> RNN with 64 hidden units and dropout (p=0.2)</li>
                    <li><strong>Input:</strong> 30-day window of normalized features (open, close, high, low)</li>
                    <li><strong>Objective:</strong> Minimize MSE between predicted and actual future returns</li>
                </ul>
            </div>
   
            <div class="methodology-section">
                <h3>Human Factors Performance</h3>
                
                <!-- 选项卡导航 -->
                <div class="tabs">
                    <button class="tablinks" onclick="openTab(event, 'momentum')">Momentum</button>
                    <button class="tablinks" onclick="openTab(event, 'liquidity')">Liquidity</button>
                    <button class="tablinks" onclick="openTab(event, 'lowvol')">LowVol</button>
                    <button class="tablinks" onclick="openTab(event, 'correlation')">Correlation</button>
                </div>
            
                <!-- 动量因子表格容器 -->
                <div id="momentum" class="tabcontent">
                    <div class="data-table">
                        <table></table> <!-- 动态生成表格 -->
                    </div>
                </div>
            
                <!-- 流动性因子表格容器 -->
                <div id="liquidity" class="tabcontent">
                    <div class="data-table">
                        <table></table>
                    </div>
                </div>
            
                <!-- 低波动因子表格容器 -->
                <div id="lowvol" class="tabcontent">
                    <div class="data-table">
                        <table></table>
                    </div>
                </div>
            
                <!-- 价量相关性表格容器 -->
                <div id="correlation" class="tabcontent">
                    <div class="data-table">
                        <table></table>
                    </div>
                </div>
            
 
                    

            <!-- 新增图片展示区 -->
            <div class="methodology-section">
                <h3>Key Visualizations</h3>
                <div class="image-gallery">
                    <div class="gallery-item">
                        <img src="Momentum Signal Performance.png" alt="Momentum Signal Performance">
                        <div class="gallery-caption">Momentum Signal Performance</div>
                    </div>
                    <div class="gallery-item">
                        <img src="Liquidity Signal Performance.png" alt="Liquidity Signal Performance">
                        <div class="gallery-caption">Liquidity Signal Performance</div>
                    </div>
                    <div class="gallery-item">
                        <img src="Low Volatility Signal Performance.png" alt="Low Volatility Signal Performance">
                        <div class="gallery-caption">Low Volatility Signal Performance</div>
                    </div>
                    <div class="gallery-item">
                        <img src="Price Volume Correlation Signal Performance.png" alt="Price Volume Correlation Signal Performance">
                        <div class="gallery-caption">Price Volume Correlation Signal Performance</div>
                    </div>
                </div>
            </div>
            <!-- ml图片添加 -->
            <div class="methodology-section">
                <h3>Machine Learning Factors Performance</h3>
                <div class="image-gallery">
                    <div class="gallery-item">
                        <img src="annualized_returns_of_decile_groups_n1.jpg" 
                             alt="Annualized Returns of Decile Groups">
                        <div class="gallery-caption">Annualized Returns by Decile (n=1)</div>
                    </div>
                    <div class="gallery-item">
                        <img src="cumulative_alpha_long_short_return_n5.jpg" 
                             alt="Cumulative Alpha Long-Short Return">
                        <div class="gallery-caption">Cumulative Long-Short Return (n=5)</div>
                    </div>
                    <div class="gallery-item">
                        <img src="cumulative_long_return_n5.jpg" 
                             alt="Cumulative Long Return">
                        <div class="gallery-caption">Cumulative Long Return (n=5)</div>
                    </div>
                    <div class="gallery-item">
                        <img src="daily_rank_IC_and_cumulative_rank_IC_n5.jpg" 
                             alt="Rank IC Analysis">
                        <div class="gallery-caption">Daily & Cumulative Rank IC (n=5)</div>
                    </div>
                </div>
            </div>
            <a href="#milestones-modal" class="see-more" id="milestones-btn">See Detailed Milestones</a>
        </div>
    </section>

    <!-- Milestones Page -->
    <section id="milestones" class="page">
        <div class="content-container">
            <h2>Project Timeline</h2>
            
            <table>
                <tr>
                    <th>Task</th>
                    <th>Timeframe</th>
                    <th>Hours</th>
                    <th>Key Activities</th>
                </tr>
                <tr>
                    <td>Data Collection & Cleaning</td>
                    <td>Mar 6 - Mar 25</td>
                    <td>50</td>
                    <td>Collect CSI index data, clean outliers, normalize</td>
                </tr>
                <tr>
                    <td>Human-Designed Factor Construction</td>
                    <td>Mar 26 - Apr 10</td>
                    <td>50</td>
                    <td>Build momentum, volatility, liquidity, price-volume factors</td>
                </tr>
                <tr>
                    <td>Machine Learning Factor Development</td>
                    <td>Apr 11 - Apr 25</td>
                    <td>50</td>
                    <td>Develop RNN model for time-series features</td>
                </tr>
                <tr>
                    <td>Factor Combination & Optimization</td>
                    <td>Apr 26 - Apr 30</td>
                    <td>20</td>
                    <td>PCA dimensionality reduction, XGBoost weighting</td>
                </tr>
                <tr>
                    <td>Portfolio Construction</td>
                    <td>May 1 - May 4</td>
                    <td>10</td>
                    <td>Decile ranking, mean-variance optimization</td>
                </tr>
                <tr>
                    <td>Backtesting Framework Setup</td>
                    <td>May 28 - Jun 10</td>
                    <td>50</td>
                    <td>Implement 5-year rolling window tests with transaction costs</td>
                </tr>
                <tr>
                    <td>Result Analysis & Visualization</td>
                    <td>Jun 11 - Jun 15</td>
                    <td>10</td>
                    <td>Generate performance metrics and charts</td>
                </tr>
                <tr>
                    <td>Final Paper Submission</td>
                    <td>Jun 26 - Jun 30</td>
                    <td>10</td>
                    <td>Complete documentation and submit results</td>
                </tr>
            </table>
            
            <h3>Deliverables</h3>
            <ul>
                <li>Cleaned dataset with human and ML factors</li>
                <li>RNN model for factor generation</li>
                <li>Optimized portfolio construction framework</li>
                <li>Backtesting results with key performance metrics</li>
                <li>Final research paper documenting methodology and findings</li>
            </ul>
        </div>
    </section>

    <!-- Aim Modal -->
    <div id="aim-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2>Project Aim</h2>
            <p>Factor generation and combination are key steps in selecting stocks for quantitative investment. Traditional linear methods have restrictions in exploring factors' capabilities to predict nonlinearities. As such, we assess whether machine learning models can be utilized to explore factors' capabilities to improve prediction.</p>
            
            <p>In this project, we integrate human-designed alpha factors with machine learning-generated factors, and combine them with tree-based models, to improve the returns of enhanced multi-factor stock selection index models.</p>
            
            <p>We validate the potential of integrating human-designed method and machine learning models in factor generation and combination through analyzing factor effectiveness, the necessity of factor selection, the correlations between factors, and backtesting performance of index enhanced portfolios.</p>
            
            <h3>Key Objectives</h3>
            <ul>
                <li>Develop a comprehensive set of human-designed factors covering momentum, volatility, liquidity, and price-volume relationships</li>
                <li>Implement RNN-based machine learning models to extract additional predictive signals from market data</li>
                <li>Create an optimized hybrid factor combination methodology using both statistical and machine learning approaches</li>
                <li>Validate the approach through rigorous backtesting with realistic transaction cost assumptions</li>
                <li>Compare performance against traditional linear factor models</li>
            </ul>
        </div>
    </div>

    <!-- Milestones Modal -->
    <div id="milestones-modal" class="modal">
    <div class="modal-content">
        <span class="close-btn">&times;</span>
        <h2>Complete Project Timeline</h2>
        
        <table>
            <tr>
                <th>Task</th>
                <th>Timeframe</th>
                <th>Hours</th>
                <th>Detailed Activities</th>
            </tr>
            <tr>
                <td>Data Collection & Cleaning</td>
                <td>Mar 6 - Mar 25 (20 days)</td>
                <td>50</td>
                <td>
                    <ul>
                        <li>Download CSI All Shares Index constituents</li>
                        <li>Filter stocks (exclude BSE, ST, low liquidity)</li>
                        <li>Collect daily price/volume and quarterly financials</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>Human-Designed Factor Construction</td>
                <td>Mar 26 - Apr 10 (16 days)</td>
                <td>50</td>
                <td>
                    <ul>
                        <li>Build momentum/reversion factors</li>
                        <li>Develop volatility measures</li>
                        <li>Create liquidity metrics</li>
                        <li>Calculate price-volume correlations</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>Machine-Learning Factor Development</td>
                <td>Apr 11 - Apr 25 (15 days)</td>
                <td>50</td>
                <td>
                    <ul>
                        <li>Preprocess data (normalization, clipping)</li>
                        <li>Implement RNN architecture</li>
                        <li>Train and validate models</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>Factor Combination & Optimization</td>
                <td>Apr 26 - Apr 30 (5 days)</td>
                <td>20</td>
                <td>
                    <ul>
                        <li>Remove redundant factors (correlation >0.7)</li>
                        <li>Apply PCA dimensionality reduction</li>
                        <li>Optimize weights using XGBoost/SHAP</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>Portfolio Construction</td>
                <td>May 1 - May 4 (4 days)</td>
                <td>10</td>
                <td>
                    <ul>
                        <li>Implement decile ranking (long top 10%)</li>
                        <li>Mean-variance optimization</li>
                        <li>Set risk controls (sector neutralization, etc.)</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>Backtesting Framework Setup</td>
                <td>May 28 - Jun 10 (14 days)</td>
                <td>50</td>
                <td>
                    <ul>
                        <li>Configure 5-year rolling window tests</li>
                        <li>Model transaction costs (0.3% total)</li>
                        <li>Handle limit-hit scenarios</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>Result Analysis & Visualization</td>
                <td>Jun 11 - Jun 15 (5 days)</td>
                <td>10</td>
                <td>
                    <ul>
                        <li>Calculate performance metrics</li>
                        <li>Generate comparative charts</li>
                        <li>Analyze factor validity (IC, ICIR)</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>Paper Writing & Revision</td>
                <td>Jun 16 - Jun 25 (10 days)</td>
                <td>50</td>
                <td>
                    <ul>
                        <li>Document methodology</li>
                        <li>Present results and analysis</li>
                        <li>Incorporate mentor feedback</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>Final Checks & Submission</td>
                <td>Jun 26 - Jun 30 (5 days)</td>
                <td>10</td>
                <td>
                    <ul>
                        <li>Quality assurance</li>
                        <li>Format adjustments</li>
                        <li>Final submission</li>
                    </ul>
                </td>
            </tr>
        </table>
        
        <h3>Total Estimated Hours: 300</h3>
    </div>
</div>

    <script>
        // Modal functionality
        const aimModal = document.getElementById('aim-modal');
        const milestonesModal = document.getElementById('milestones-modal');
        const seeMoreBtn = document.getElementById('see-more-btn');
        const milestonesBtn = document.getElementById('milestones-btn');
        const closeBtns = document.querySelectorAll('.close-btn');
        
        // Open modals
        seeMoreBtn.addEventListener('click', (e) => {
            e.preventDefault();
            aimModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        });
        
        milestonesBtn.addEventListener('click', (e) => {
            e.preventDefault();
            milestonesModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        });
        
        // Close modals
        closeBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                aimModal.style.display = 'none';
                milestonesModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            });
        });
        
        // Close when clicking outside modal
        window.addEventListener('click', (e) => {
            if (e.target === aimModal) {
                aimModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
            if (e.target === milestonesModal) {
                milestonesModal.style.display = 'none';
                document.body.style.overflow = 'auto';
            }
        });
        
        // Fix for background image on mobile
        window.addEventListener('load', function() {
            const homeSection = document.getElementById('home');
            if (window.innerWidth <= 768) {
                homeSection.style.backgroundAttachment = 'scroll';
            }
        });
    
    </script>
    <script src="js/factor_data.js"></script> <!-- 确保路径正确 -->
    <script>
    // 表格初始化函数
    function initFactorTables() {
        if (typeof factorData === 'undefined') {
            console.error('factorData未加载，检查文件路径或内容');
            return;
        }
    
        Object.keys(factorData).forEach(sheet => {
            const tabId = sheet.toLowerCase();
            const tabContent = document.getElementById(tabId);
            if (!tabContent) {
                console.warn(`未找到ID为${tabId}的选项卡容器`);
                return;
            }
    
            const table = tabContent.querySelector('table');
            if (!table) return;
    
            // 清空现有内容
            table.innerHTML = '';
    
            // 创建表头
            const headers = Object.keys(factorData[sheet][0]);
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header
                    .replace(/_/g, ' ')
                    .replace(/([A-Z])/g, ' $1')
                    .replace(/^\w/, c => c.toUpperCase());
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);
    
            // 创建数据行
            const tbody = document.createElement('tbody');
            factorData[sheet].forEach(row => {
                const tr = document.createElement('tr');
                headers.forEach(header => {
                    const td = document.createElement('td');
                    let value = row[header];
                    // 数值格式化
                    if (typeof value === 'number') {
                        value = value.toFixed(6).replace(/\.?0+$/, '');
                        if (value.endsWith('.')) value = value.slice(0, -1);
                    }
                    td.textContent = value || '—';
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });
            table.appendChild(tbody);
        });
    }
    
    // 选项卡切换函数
    function openTab(evt, tabName) {
        // 隐藏所有内容
        document.querySelectorAll('.tabcontent').forEach(tab => {
            tab.style.display = 'none';
        });
    
        // 移除所有激活状态
        document.querySelectorAll('.tablinks').forEach(btn => {
            btn.classList.remove('active');
        });
    
        // 显示目标内容并激活按钮
        document.getElementById(tabName).style.display = 'block';
        evt.currentTarget.classList.add('active');
    }
    
    // 页面初始化
    window.addEventListener('DOMContentLoaded', () => {
        initFactorTables();
        
        // 默认激活第一个选项卡
        const firstTabBtn = document.querySelector('.tablinks');
        if (firstTabBtn) {
            const firstTabId = firstTabBtn.getAttribute('onclick').match(/'([^']+)'/)[1];
            firstTabBtn.classList.add('active');
            document.getElementById(firstTabId).style.display = 'block';
        }
    
        // 绑定选项卡点击事件
        document.querySelectorAll('.tablinks').forEach(btn => {
            btn.addEventListener('click', function(e) {
                openTab(e, this.getAttribute('onclick').match(/'([^']+)'/)[1]);
            });
        });
    });
    </script>          

</body>
</html>